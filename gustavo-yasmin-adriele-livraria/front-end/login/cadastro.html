<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cadastro - Livraria Web</title>
  <link rel="stylesheet" href="./login.css" />
</head>

<body>
  <div class="login-container">
    <h2>Cadastre-se</h2>
    <form action="./cadastro.php" method="post">
      <label for="nome">Nome Completo:</label>
      <input type="text" id="nome" name="nome" required />

      <label for="email">E-mail:</label>
      <input type="email" id="email" name="email" required />

      <label for="senha">Senha:</label>
      <input type="password" id="senha" name="senha" required minlength="6" />

      <label for="confirmaSenha">Confirme a Senha:</label>
      <input type="password" id="confirmaSenha" name="confirmaSenha" required minlength="6" />

      <button id="btn-cadastrar" type="submit">Cadastrar</button>
      <p class="link-cadastro">
        Já tem conta? <a href="login.html">Entrar aqui</a>
      </p>
    </form>
  </div>

  <script>
    // Validação simples para senhas iguais antes de enviar
    const form = document.querySelector("form");
    form.addEventListener("submit", (e) => {
      const senha = document.getElementById("senha").value;
      const confirmaSenha = document.getElementById("confirmaSenha").value;
      if (senha !== confirmaSenha) {
        e.preventDefault();
        alert("As senhas não coincidem!");
      }
    });

    function dataCadastro() {
      const dataAtual = new Date();

      // 2. Extrai os componentes da data
      const dia = String(dataAtual.getDate()).padStart(2, '0'); // Obtém o dia e garante que tenha 2 dígitos
      const mes = String(dataAtual.getMonth() + 1).padStart(2, '0'); // Obtém o mês (adicionando 1 pois é baseado em 0) e garante 2 dígitos
      const ano = dataAtual.getFullYear(); // Obtém o ano

      // 3. Formata a data no padrão dia/mês/ano
      const dataFormatada = `${ano}-${mes}-${dia}`;
      return dataFormatada;
    }

    const btnCadastrar = document.querySelector('#btn-cadastrar')
    btnCadastrar.addEventListener('click', (event) => {
      event.preventDefault();
      const formData = new FormData(form);
      const usuario = {
        nome: formData.get('nome'),
        email: formData.get('email'),
        senha: formData.get('senha'),
        data_cadastro: dataCadastro()
      }
    });
    console.log(usuario);
    fetch('http://localhost:3000/cadastrarusuario', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(usuario)
    });


  </script>
</body>

</html>